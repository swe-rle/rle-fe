<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Rlm</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Favicons -->
<link href="assets/img/transperant-logo.png" rel="icon">
<link href="assets/img/transperant-logo.png" rel="apple-touch-icon">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,600,600i,700,700i" rel="stylesheet">
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>  
<script async src="https://cse.google.com/cse.js?cx=4579cd520ae3c4467">
</script>
<script src="https://accounts.google.com/gsi/client" async defer></script>

</head>
<body>
  <app-root></app-root>
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script>
  function parseJwt (token) {
  var base64Url = token.split('.')[1];
  var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
  var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
  }).join(''));

  return JSON.parse(jsonPayload);
}

  function handleCredentialResponse(response) {
  // decodeJwtResponse() is a custom function defined by you
  // to decode the credential response.
  const responsePayload = parseJwt(response.credential);
  console.log(responsePayload,response.credential)
  console.log("ID: " + responsePayload.sub);
  console.log('Full Name: ' + responsePayload.name);
  console.log('Given Name: ' + responsePayload.given_name);
  console.log('Family Name: ' + responsePayload.family_name);
  console.log("Image URL: " + responsePayload.picture);
  console.log("Email: " + responsePayload.email);
  fetch("http://localhost:8000/auth/signin", {
  method: "POST",
  credentials:"include",
  body: JSON.stringify({
    lab_id: 6,
    g_token: response.credential,
  }),
  headers: {
    "Content-type": "application/json; charset=UTF-8"
  }
});
  }
</script>
</body>
</html>
